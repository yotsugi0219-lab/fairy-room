:root{
  --bg:#0f1013;
  --ink:#f5f7fb;
  --muted:#9ba7b6;
  --card:#17181c;
  --line:#2a2d36;
  --pill:#21242c;
  /* ä¸‹ãƒ‘ãƒãƒ«ã®å£ç´™è‰²ï¼ˆã‚·ãƒ§ãƒƒãƒ—ã§å¤‰æ›´ï¼‰ */
  --panel-wall:#17181c;
}

*{box-sizing:border-box; -webkit-tap-highlight-color:transparent;}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font:16px/1.6 -apple-system,BlinkMacSystemFont,"Hiragino Sans","Noto Sans JP",sans-serif;
  user-select:none;
}
img{ -webkit-user-drag:none; user-select:none; pointer-events:none; display:block; }

.wrap{ max-width:780px; margin:12px auto 48px; padding:0 12px; }

/* ========== éƒ¨å±‹ï¼ˆ16:9å›ºå®šï¼‰ ========== */
.room{
  position:relative; width:100%; aspect-ratio:16/9;
  margin:10px auto; border-radius:16px; overflow:hidden;
  background:#1b1e25; box-shadow:0 12px 24px rgba(0,0,0,.25);
}/* èƒŒæ™¯ãƒ¬ã‚¤ãƒ¤ã ã‘ã«é©ç”¨ã™ã‚‹ç‰ˆï¼ˆå¦–ç²¾ã¯å«ã‚ãªã„ï¼‰ */
.room > img.room-base,
.room > img.room-sky,
.room > img.window-frame{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
}
.room-base{ z-index:1; }

/* çª“ã®ç©ºï¼ˆä½ç½®ã¯çµµã«åˆã‚ã›ã¦ï¼…æŒ‡å®šã€‚å¿…è¦ãªã‚‰å¾®èª¿æ•´ï¼‰ */
.room-sky{
  z-index:2; pointer-events:none;
  width:38%; height:38%; left:9%; top:9%;
  object-fit:cover; clip-path:inset(0 round 6px);
}
.window-frame{
  z-index:3; pointer-events:none;
  width:38%; height:38%; left:9%; top:9%; object-fit:cover;
}

/* å¦–ç²¾ï¼ˆä¸­å¤®åŸºæº–ãƒ»æš´ã‚Œãªã„clampï¼‰ */
.fairy{
  z-index:4; position:absolute;
  /* â–¼ã“ã“ã‚’è¿½åŠ ï¼ˆã¾ãŸã¯ top/right ã‚’å€‹åˆ¥ã«ï¼‰ */
  inset: auto;        /* â† ã“ã‚Œã§ .room img ã® inset:0 ã‚’æ‰“ã¡æ¶ˆã™ */
  /* top:auto; right:auto; ã§ã‚‚OK */
  left:50%; transform:translateX(-50%);
  bottom:8%;
  width:clamp(80px, 15vw, 128px);
  height:auto; object-fit:contain; border-radius:12px;
}

/* ï¾ˆï¾ï¾ˆæ™‚ï¼šãƒ™ãƒƒãƒ‰ä¸­å¤®ã«ã‚¹ãƒŠãƒƒãƒ—ï¼ˆå¿…è¦ã«å¿œã˜ã¦å¾®èª¿æ•´OKï¼‰ */
.fairy.sleeping {
  left:50%;
  top:35% !important;
  bottom:auto !important;
  transform:translateX(-160%); /* â† -50% ã‹ã‚‰ -60% ã«ã™ã‚‹ã¨10%å·¦å¯„ã› */
  width:clamp(72px, 12vw, 108px);
}

/* ã‚»ãƒªãƒ•ï¼ˆç«‹ã¡å§¿ç”¨ã®æ¨™æº–ä½ç½®ï¼‰ */
.speech {
  position:absolute;
  left:50%;
  bottom:26%;                /* â†ãµã ã‚“ã¯ä½ã‚ã« */
  transform:translateX(-50%);
  z-index:6;
  background:rgba(0,0,0,.75);
  padding:8px 12px;
  border-radius:12px;
  border:1px solid var(--line);
  box-shadow:0 6px 16px rgba(0,0,0,.35);
  font-size:14px;
}
/* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆå¦–ç²¾ã•ã‚“ã®ä½ç½®ï¼‰ */
.speech {
  position: absolute;
  left: 50%;
  bottom: 36%;
  transform: translateX(-50%);
  z-index: 5;
  pointer-events: none;
  max-width: 70%;   /* â† æœ€å¤§å¹…ã ã‘æŒ‡å®š */
  padding: 6px 10px; /* â† ãƒ†ã‚­ã‚¹ãƒˆã«ä½™ç™½ã‚’ã¤ã‘ã‚‹ */
  display: inline-block; /* â† å¹…ã‚’ä¸­èº«ã«åˆã‚ã›ã‚‹ãŸã‚ã«è¿½åŠ  */
  box-sizing: border-box;
}

/* ï½µï½·ï½¬ï½¸ï½»ï¾ãŒè©±ã™ã¨ãã¯å°‘ã—å³ã«å¯„ã›ã‚‹ï¼ˆãã®ã¾ã¾ã§OKï¼‰ */
.speech.from-guest{
  left: calc(50% + 90px);
  transform: translateX(-50%);
}

/* ç«¯æœ«ãŒå°ã•ã„ã¨ãã ã‘å°‘ã—ä¸Šã’ã‚‹ï¼ˆä»»æ„ï¼‰ */
@media (max-width: 420px){
  .speech{ bottom: 40%; }   /* å¥½ã¿ã§ 38ã€œ42% ã®é–“ã§å¾®èª¿æ•´ */
}
.speech.hidden { display:none; }

/* âœ… å¦–ç²¾ãŒå¯å§¿ã®ã¨ãã ã‘ã€å¹ãå‡ºã—ã‚’ä¸Šã’ã‚‹ */
#fairy.sleeping + #speech {
  bottom:44%;   /* å¥½ã¿ã§ 40ã€œ48% ã«èª¿æ•´ã—ã¦ã­ */
}

/* ãŠã‚„ã¤è½ä¸‹ãƒ¬ã‚¤ãƒ¤ï¼ˆéƒ¨å±‹å†…ï¼‰ */
/* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãƒ¬ã‚¤ãƒ¤ã¯ãã®ã¾ã¾ */
.fx{ position:absolute; inset:0; z-index:5; pointer-events:none; }

/* ğŸ¬ ãŠã‚„ã¤ï¼šçœŸã£ç›´ãè½ä¸‹ï¼ˆSafariã§ã‚‚ç¢ºå®Ÿã«å‹•ãç‰ˆï¼‰ */
.snack{
  position:absolute;
  left: var(--x, 50%);     /* ä¸­å¤®ã€‚å¤‰ãˆãŸã‘ã‚Œã° 10%ã€œ90% ã‚’JSã§å…¥ã‚Œã‚‹ */
  top: -20%;               /* ç”»é¢ä¸Šç©ºã‚¹ã‚¿ãƒ¼ãƒˆ */
  transform: translateX(-50%); /* ä¸­å¤®å¯„ã›ã ã‘transformã§ */
  font-size:26px;
  filter: drop-shadow(0 2px 2px rgba(0,0,0,.25));
  animation: fall var(--t, 1400ms) linear forwards;
}

/* â† translateã‚’ã‚„ã‚ã¦ã€top ã‚’ç›´æ¥å‹•ã‹ã™ */
@keyframes fall{
  to { top: 130%; opacity:.95; }  /* éƒ¨å±‹ã®åºŠã‚’è¶…ãˆã¦ä¸‹ã¾ã§æŠœã‘ã‚‹ */
}

/* ========== ä¸‹ãƒ‘ãƒãƒ«ï¼ˆéãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ ========== */
.panel{
  background:var(--panel-wall);
  border:1px solid var(--line);
  border-radius:16px; padding:12px; margin-top:12px;
  box-shadow:0 10px 24px rgba(0,0,0,.25);
}
.status div{ margin:4px 0; font-size:18px; }

.commands .row{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center; }
.inline{ display:inline-flex; gap:10px; align-items:center; }

.pill{
  appearance:none; border:none; background:var(--pill); color:var(--ink);
  border-radius:999px; padding:10px 18px; font-weight:700; min-width:92px;
  box-shadow: inset 0 0 0 1px var(--line);
}
.pill:active{ transform:translateY(1px); }
.pill.mini{ min-width:auto; padding:8px 12px; font-weight:600; }
.pill.accent{ box-shadow: inset 0 0 0 2px #5e76ff; }

/* ã‚·ãƒ§ãƒƒãƒ—å¸¯ */
.shop.hidden{ display:none; }
.shop-hd{ display:flex; align-items:center; justify-content:space-between; }
.shop-grid{
  display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:10px;
}
.shop-item{
  background:#1b1f26; border:1px solid var(--line); border-radius:12px; padding:10px; text-align:center;
}
.shop-item .label{ margin-top:6px; }
.shop-item button{ margin-top:8px; }

/* å®‰å®šåŒ– */
.hidden{ display:none !important; }

/* ãŠå®¢ã•ã‚“ã®è¦‹ãŸç›®ï¼šå·¦å´ã«å°ã•ã‚ã§ã¡ã‚‡ã“ã‚“ */
/* ã‚²ã‚¹ãƒˆç«‹ã¡çµµ */
.guest {
  position: absolute;
  left: calc(50% + 70px);   /* å¦–ç²¾ã®å³æ¨ªã«å‡ºã™ã€‚å¥½ã¿ã§èª¿æ•´ */
  bottom: 8%;
  transform: translateX(-50%);
  pointer-events: none;
  opacity: 0;
  transition: opacity .2s ease;
  width: 85px;             /* ç”»åƒã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦èª¿æ•´ */
}
