:root{
  --bg:#0f0f11;
  --panel:#14161b;
  --panel-border:#242832;
  --ink:#f5f7fb;
  --muted:#93a0b6;
  --accent:#8aa6ff;
  --pill:#21242c;
  --shadow:rgba(0,0,0,.25);
  --panel-wall:#14161b; /* ショップで変える壁紙色 */
}

*{ box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
html,body{ height:100%; }
body{
  margin:0; background:var(--bg); color:var(--ink);
  font:16px/1.6 -apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN",
       "Yu Gothic","YuGothic","Noto Sans JP",sans-serif;
  user-select:none;
}
img{ -webkit-user-drag:none; user-select:none; pointer-events:none; }

.wrap{ max-width:820px; margin:12px auto 64px; padding:0 12px; }

.room{
  position:relative; border-radius:16px; overflow:hidden;
  background:#1a1f27; box-shadow:0 12px 24px var(--shadow);
  aspect-ratio: 16 / 9; /* スマホでも崩れにくい */
}
.room img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; }
.frame-art{ z-index:3; pointer-events:none; }
.room-sky{ z-index:2; }
.room-base{ z-index:1; }
.fairy{
  z-index:4; width:min(24%,180px); aspect-ratio: 1/1;
  left:50%; bottom:8%; transform:translateX(-50%);
  object-fit:contain; border-radius:12px;
}

/* セリフ */
.say{
  position:absolute; left:50%; bottom:12%;
  transform:translate(-50%,0); z-index:5;
  background:rgba(20,22,27,.9); border:1px solid var(--panel-border);
  padding:8px 12px; border-radius:12px; font-size:14px;
}
.hidden{ display:none; }

/* パネル */
.panel{
  background:var(--panel-wall);
  border:1px solid var(--panel-border);
  border-radius:16px; padding:14px; margin-top:12px;
  box-shadow:0 8px 16px var(--shadow);
}
.panel.status{ font-size:18px; }
.pill{
  display:inline-flex; align-items:center; justify-content:center;
  background:var(--pill); color:var(--ink);
  border:1px solid var(--panel-border);
  padding:10px 18px; border-radius:999px; margin:8px 10px 0 0;
  font-weight:600;
}

/* モーダル */
.modal{
  position:fixed; inset:0; z-index:20; display:flex;
  align-items:center; justify-content:center;
  background:rgba(0,0,0,.55);
}
.modal .modal-body{
  width:min(92vw,720px); background:var(--panel);
  border:1px solid var(--panel-border); border-radius:16px;
  box-shadow:0 16px 32px var(--shadow); padding:12px;
}
.modal-head{ display:flex; align-items:center; justify-content:space-between; }
.mini{ font-size:14px; padding:6px 12px; border-radius:10px; }
.shop-grid{
  display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:10px;
}
.shop-grid button{
  padding:10px; border-radius:12px; background:#1c212a;
  border:1px solid var(--panel-border); color:var(--ink);
  min-height:64px;
}
.note{ color:var(--muted); }

/* スナック落下 */
.snack-layer{
  pointer-events:none; position:fixed; inset:0; z-index:30;
  overflow:hidden; font-size:24px;
}
.snack{ position:absolute; top:-40px; }
@keyframes fall {
  to { transform:translateY(110vh) rotate(360deg); opacity:.9; }
}

/* ふわジャンプ */
@keyframes pop {
  0%{ transform:translate(-50%,0) scale(1); }
  30%{ transform:translate(-50%,-22%) scale(1.05); }
  60%{ transform:translate(-50%,0) scale(1); }
}
.jump{ animation:pop .6s ease-out; }
