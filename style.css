:root{
  --bg:#0f1013;
  --ink:#f5f7fb;
  --muted:#9ba7b6;
  --card:#17181c;
  --line:#2a2d36;
  --pill:#21242c;
  /* 下パネルの壁紙色（ショップで変更） */
  --panel-wall:#17181c;
}

*{box-sizing:border-box; -webkit-tap-highlight-color:transparent;}
html,body{height:100%}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font:16px/1.6 -apple-system,BlinkMacSystemFont,"Hiragino Sans","Noto Sans JP",sans-serif;
  user-select:none;
}
img{ -webkit-user-drag:none; user-select:none; pointer-events:none; display:block; }

.wrap{ max-width:780px; margin:12px auto 48px; padding:0 12px; }

/* ========== 部屋（16:9固定） ========== */
.room{
  position:relative; width:100%; aspect-ratio:16/9;
  margin:10px auto; border-radius:16px; overflow:hidden;
  background:#1b1e25; box-shadow:0 12px 24px rgba(0,0,0,.25);
}/* 背景レイヤだけに適用する版（妖精は含めない） */
.room > img.room-base,
.room > img.room-sky,
.room > img.window-frame{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
}
.room-base{ z-index:1; }

/* 窓の空（位置は絵に合わせて％指定。必要なら微調整） */
.room-sky{
  z-index:2; pointer-events:none;
  width:38%; height:38%; left:9%; top:9%;
  object-fit:cover; clip-path:inset(0 round 6px);
}
.window-frame{
  z-index:3; pointer-events:none;
  width:38%; height:38%; left:9%; top:9%; object-fit:cover;
}

/* 妖精（中央基準・暴れないclamp） */
.fairy{
  z-index:4; position:absolute;
  /* ▼ここを追加（または top/right を個別に） */
  inset: auto;        /* ← これで .room img の inset:0 を打ち消す */
  /* top:auto; right:auto; でもOK */
  left:50%; transform:translateX(-50%);
  bottom:8%;
  width:clamp(80px, 15vw, 128px);
  height:auto; object-fit:contain; border-radius:12px;
}

/* ﾈﾝﾈ時：ベッド中央にスナップ（必要に応じて微調整OK） */
.fairy.sleeping {
  left:50%;
  top:35% !important;
  bottom:auto !important;
  transform:translateX(-160%); /* ← -50% から -60% にすると10%左寄せ */
  width:clamp(72px, 12vw, 108px);
}

/* セリフ（立ち姿用の標準位置） */
.speech {
  position:absolute;
  left:50%;
  bottom:26%;                /* ←ふだんは低めに */
  transform:translateX(-50%);
  z-index:6;
  background:rgba(0,0,0,.75);
  padding:8px 12px;
  border-radius:12px;
  border:1px solid var(--line);
  box-shadow:0 6px 16px rgba(0,0,0,.35);
  font-size:14px;
}

.speech.hidden { display:none; }

/* ✅ 妖精が寝姿のときだけ、吹き出しを上げる */
#fairy.sleeping + #speech {
  bottom:44%;   /* 好みで 40〜48% に調整してね */
}

/* おやつ落下レイヤ（部屋内） */
.fx{ position:absolute; inset:0; z-index:5; pointer-events:none; }
.snack{
  position:absolute; top:-10%; font-size:26px; filter:drop-shadow(0 2px 2px rgba(0,0,0,.25));
  animation: fall var(--t,1200ms) linear forwards, wiggle 700ms ease-in-out infinite alternate;
}
@keyframes fall{ to { transform: translateY(110%); opacity:.95; } }
@keyframes wiggle{ from{transform:translateX(-6px)} to{transform:translateX(6px)} }

/* ========== 下パネル（非モーダル） ========== */
.panel{
  background:var(--panel-wall);
  border:1px solid var(--line);
  border-radius:16px; padding:12px; margin-top:12px;
  box-shadow:0 10px 24px rgba(0,0,0,.25);
}
.status div{ margin:4px 0; font-size:18px; }

.commands .row{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center; }
.inline{ display:inline-flex; gap:10px; align-items:center; }

.pill{
  appearance:none; border:none; background:var(--pill); color:var(--ink);
  border-radius:999px; padding:10px 18px; font-weight:700; min-width:92px;
  box-shadow: inset 0 0 0 1px var(--line);
}
.pill:active{ transform:translateY(1px); }
.pill.mini{ min-width:auto; padding:8px 12px; font-weight:600; }
.pill.accent{ box-shadow: inset 0 0 0 2px #5e76ff; }

/* ショップ帯 */
.shop.hidden{ display:none; }
.shop-hd{ display:flex; align-items:center; justify-content:space-between; }
.shop-grid{
  display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:10px;
}
.shop-item{
  background:#1b1f26; border:1px solid var(--line); border-radius:12px; padding:10px; text-align:center;
}
.shop-item .label{ margin-top:6px; }
.shop-item button{ margin-top:8px; }

/* 安定化 */
.hidden{ display:none !important; }
